<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>Triggering GitHub Actions From Outside of GitHub | Mike Ball</title><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=generator content="Hugo 0.101.0"><meta name=ROBOTS content="INDEX, FOLLOW"><link rel=stylesheet href=/main.min.e66e54ba1d571b502b0a6cb14d84fda0e110bded0c03ee0fcf4b31cf60947bb3.css></head><body class=blog-post><header><div class=mark><a href=/>Mike Ball</a></div><button>Toggle Navigation</button><div class=nav-wrap><nav class=primary><ul><li><a href=/blog>Blog</a></li><li><a href=#about>About</a></li></ul></nav><nav class=secondary><ul><li><a href=https://github.com/mdb>GitHub</a></li><li><a href=https://instagram.com/clapclapexcitement>Instagram</a></li></ul></nav><nav class=tertiary><ul><li><a href=https://tiendah.bigcartel.com>Shop</a></li><li><a href=#about>Contact</a></li></ul></nav></div></header><main role=main><div class=blog-post><aside class=divider><a href=/blog/>Blog</a></aside><time>July 1, 2021</time><article><header><h1>Triggering GitHub Actions From Outside of GitHub</h1></header><div><p><em>An introduction to using custom repository dispatch events to trigger GitHub Actions from outside of GitHub.</em></p><p>Often, <a href=https://docs.github.com/en/actions>GitHub Actions</a> are configured to trigger in response to common <a href=https://docs.github.com/en/actions/reference/events-that-trigger-workflows>GitHub events</a>, such as pushing a git commit, opening a pull request, or creating a git tag. But how can GitHub Actions workflows be triggered from events outside of GitHub? GitHub&rsquo;s <a href=https://docs.github.com/en/actions/reference/events-that-trigger-workflows#repository_dispatch><code>repository_dispatch</code></a> event offers a solution.</p><h2 id=a-basic-example>A basic example</h2><p>First, create a <code>.github/workflows/repo_dispatch_example.yml</code> file (the name is arbitrary, though its location and <code>.yml</code> extension do matter):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=display:flex><span><span style=color:#f92672>name</span>: <span style=color:#ae81ff>Hello</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>on</span>:
</span></span><span style=display:flex><span>  <span style=color:#ae81ff>repository_dispatch</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>jobs</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>greet</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>runs-on</span>: <span style=color:#ae81ff>ubuntu-latest</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>steps</span>:
</span></span><span style=display:flex><span>      - <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>actions/checkout@v2</span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Say-Hello</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>run</span>: <span style=color:#ae81ff>echo &#34;Hello!&#34;</span>
</span></span></code></pre></div><p>After committing and pushing the <code>.github/workflows/repo_dispatch_example.yml</code> file, the <code>Hello</code> workflow&rsquo;s <code>greet</code> job can be triggered via a GitHub API request (note that this assumes a <code>GITHUB_TOKEN</code> environment variable whose value is an authorized <a href=https://docs.github.com/en/github/authenticating-to-github/keeping-your-account-and-data-secure/creating-a-personal-access-token>GitHub personal access token</a>):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>curl <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --header <span style=color:#e6db74>&#34;Accept: application/vnd.github.v3+json&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --header <span style=color:#e6db74>&#34;Authorization: token </span><span style=color:#e6db74>${</span>GITHUB_TOKEN<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --request <span style=color:#e6db74>&#34;POST&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --data <span style=color:#e6db74>&#39;{&#34;event_type&#34;: &#34;hello&#34;}&#39;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  <span style=color:#e6db74>&#34;https://api.github.com/repos/&lt;OWNER&gt;/&lt;REPOSITORY&gt;/dispatches&#34;</span>
</span></span></code></pre></div><p>As a result, the <code>Hello</code> workflow is triggered and its <code>Say-Hello</code> step prints <code>Hello!</code>.</p><h2 id=a-slightly-more-advanced-example>A slightly more advanced example</h2><p>The above <code>Hello</code> workflow implementation responds to any properly issued repository dispatch API request. However, GitHub Actions also supports the ability to configure workflows that only respond to specific events, as well as the ability to pass arbitrary data to the workflow via the repository dispatch API request payload. The following variation of <code>.github/workflows/repo_dispatch_example.yml</code> is <em>only</em> triggered by repository dispatch API requests whose <code>event_type</code> is <code>hello</code>, and also uses a <code>name</code> from the request payload&rsquo;s <code>client_payload</code> field:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=display:flex><span><span style=color:#f92672>name</span>: <span style=color:#ae81ff>Hello</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>on</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>repository_dispatch</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>type</span>: [<span style=color:#e6db74>&#34;hello&#34;</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>jobs</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>greet</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>runs-on</span>: <span style=color:#ae81ff>ubuntu-latest</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>steps</span>:
</span></span><span style=display:flex><span>      - <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>actions/checkout@v2</span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Say-Hello</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>run</span>: <span style=color:#ae81ff>echo &#34;Hello, ${{ github.event.client_payload.name }}!&#34;</span>
</span></span></code></pre></div><p>The new <code>Hello</code> workflow can be triggered like so:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>curl <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --header <span style=color:#e6db74>&#34;Accept: application/vnd.github.v3+json&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --header <span style=color:#e6db74>&#34;Authorization: token </span><span style=color:#e6db74>${</span>GITHUB_TOKEN<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --request <span style=color:#e6db74>&#34;POST&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --data <span style=color:#e6db74>&#39;{&#34;event_type&#34;: &#34;hello&#34;, &#34;client_payload&#34;: {&#34;name&#34;:&#34;Mike&#34;}}&#39;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  <span style=color:#e6db74>&#34;https://api.github.com/repos/&lt;OWNER&gt;/&lt;REPOSITORY&gt;/dispatches&#34;</span>
</span></span></code></pre></div><p>This results in a <code>Say-Hello</code> step that prints <code>Hello, Mike!</code>, as seen in <a href="https://github.com/mdb/mikeball.info/runs/2968213309?check_suite_focus=true">this example</a>.</p><p>However, requests whose payloads specify an <code>event_type</code> other than <code>hello</code>, such as the following, no longer trigger the <code>Hello</code> workflow:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>curl <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --header <span style=color:#e6db74>&#34;Accept: application/vnd.github.v3+json&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --header <span style=color:#e6db74>&#34;Authorization: token </span><span style=color:#e6db74>${</span>GITHUB_TOKEN<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --request <span style=color:#e6db74>&#34;POST&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --data <span style=color:#e6db74>&#39;{&#34;event_type&#34;: &#34;goodbye&#34;}&#39;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  <span style=color:#e6db74>&#34;https://api.github.com/repos/&lt;OWNER&gt;/&lt;REPOSITORY&gt;/dispatches&#34;</span>
</span></span></code></pre></div><h2 id=gotchas>Gotchas</h2><p>Based on experimentation, it <em>seems</em> requests to <code>repos/&lt;OWNER>/&lt;REPOSITORY>/dispatches</code> only trigger workflows whose <code>.github/workflows/*.yml</code> configuration exists in the repository&rsquo;s default branch.</p><h2 id=2022-update>2022 update</h2><p>I created the <a href=https://github.com/mdb/gh-dispatch/>gh-dispatch</a> <code>gh</code> CLI extension for triggering <a href=https://docs.github.com/en/rest/repos/repos#create-a-repository-dispatch-event>repository_dispatch</a> and/or
<a href=https://docs.github.com/en/actions/using-workflows/events-that-trigger-workflows#workflow_dispatch>workflow_dispatch</a> events and watching the resulting GitHub Actions
workflow run. The tool offers a CLI for performing <code>POST /repos/&lt;OWNER>/&lt;REPOSITORY>/dispatches</code> requests like those described above, and also enables users to watch the resulting GitHub Actions workflow run directly from the terminal:</p><p><img src=/images/blog/gh_dispatch_demo.gif alt=demo></p></div><ul class=tags><li><a href=/tags/github>github</a></li><li><a href=/tags/ci/cd>CI/CD</a></li></ul></article></div></main><footer><section><h1 id=about>Info</h1><div><h2>Mike Ball</h2><p>I live in Philadelphia and work as a multi-disciplinary software engineer & designer.</p><p>Over the years, I've developed front end web applications, built backend services, automated cloud infrastructure management, designed CI/CD pipelines for high scale distributed systems, and contributed to numerous open source software projects.</p><p>I've also worked in graphic and UX design. Buy prints of my illustrations at <a href=https://tiendah.bigcartel.com>Tiendah</a>.</div><div class=double><h2>Shop Tiendah</h2><ul class="gallery store-feed"></ul><h2>Instagram</h2><ul class="gallery ig-feed"></ul></div><div><h2>Etc.</h2><ul><li><a href=http://github.com/mdb>GitHub</a></li><li><a href=http://twitter.com/clapexcitement>Twitter</a></li><li><a href=https://instagram.com/clapclapexcitement>Instagram</a></li><li><a href=/index.xml>RSS Feed</a></li><li><a href=https://tiendah.bigcartel.com>Shop Tiendah</a></li></ul><h2>Contact</h2><p>Interested in working with me? <a href=mailto:mikedball@gmail.com>Get in touch</a>.</p></div></section></footer><script type=text/javascript src=/js/main.min.5d3e1e570343926cb3ff35c8e4730eac1200594ead7be05a1c97996e632be67e.js></script>
<script type=text/javascript>(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)})(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-54324621-1","auto"),ga("send","pageview")</script></body></html>