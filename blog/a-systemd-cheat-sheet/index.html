<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>A systemd Cheat Sheet | Mike Ball</title><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=generator content="Hugo 0.101.0"><meta name=ROBOTS content="INDEX, FOLLOW"><link rel=stylesheet href=/main.min.1793cf78540015f52d445efeea219c2a3ab4bc17725ba6b8caf459edd42ba3ae.css></head><body class=blog-post><header><div class=mark><a href=/>Mike Ball</a></div><button>Toggle Navigation</button><div class=nav-wrap><nav class=primary><ul><li><a href=/blog>Blog</a></li><li><a href=#about>About</a></li></ul></nav><nav class=secondary><ul><li><a href=https://github.com/mdb>GitHub</a></li><li><a href=https://instagram.com/clapclapexcitement>Instagram</a></li></ul></nav><nav class=tertiary><ul><li><a href=https://tiendah.bigcartel.com>Shop</a></li><li><a href=#about>Contact</a></li></ul></nav></div></header><main role=main><div class=blog-post><aside class=divider><a href=/blog/>Blog</a></aside><time>December 18, 2020</time><article><header><h1>A systemd Cheat Sheet</h1></header><div><p><em>Generally, <code>systemd</code> is the standard init system across Linux
distributions. <code>systemctl</code> is its central CLI management tool.
This is a brief overview and cheat sheet.</em></p><h2 id=background>Background</h2><ul><li><code>systemd</code> is responsible for initializing and managing components, services,
and daemons that must be started after the kernel is booted. Such components
are often referred to as &ldquo;userland&rdquo; components.</li><li>resources managed by <code>systemd</code> are called <em>units</em>; these are defined in unit
files</li><li>service management unit files are suffixed with a <code>.service</code> (though there are
other types of units too, such as <code>.socket</code>, <code>.device</code>, <code>.mount</code>, etc. This overview
focuses on <code>.service</code> units, though)</li></ul><h2 id=startingstopping-services>Starting/Stopping services</h2><ul><li><code>systemctl start something.service</code> - start a service</li><li><code>systemctl stop something.service</code> - stop a service</li><li><code>systemctl restart something.service</code> - restart a service</li></ul><h2 id=reloading-configuration>Reloading configuration</h2><ul><li><code>systemctl reload something.service</code> - reload a service&rsquo;s configuration
without restarting the service, assuming the service is capable of this</li><li><code>systemctl reload-or-restart something.service</code> - reload a service&rsquo;s
configuration in place, if the service is capable of doing so (otherwise, restart the
service to pick up the new configuration)</li><li><code>systemctl daemon-reload</code> reloads the entire <code>systemd</code> process</li></ul><h2 id=enabling-services>Enabling services</h2><ul><li><code>systemctl enable something.service</code> - <em>enable</em> a service, causing the service
to be automatically started at boot (Note, however, this does not start the
service in the current session; that still requires a <code>start</code>)</li><li><code>systemctl disable something.service</code> - disable a service from starting at boot</li></ul><h2 id=querying-status>Querying status</h2><ul><li><code>systemctl status something.service</code> - outputs the service&rsquo;s state, the cgroup hierarchy, and the first serveral log lines</li><li><code>systemctl is-active something.service</code> - reports if a service is running</li><li><code>systemctl is-enabled something.service</code> - reports if a service is enabled</li><li><code>systemctl is-failed something.service</code> - reports if a service is in a failed state</li></ul><h2 id=learning-more-about-a-systems-units>Learning more about a system&rsquo;s units</h2><ul><li><code>systemctl list-units</code> - lists active units</li><li><code>systemctl list-units --all --state=active</code> - lists all active units</li></ul><p>(Other options exist too.)</p><h2 id=learning-more-about-a-units-details>Learning more about a unit&rsquo;s details</h2><ul><li><code>systemctl cat something.service</code> - output the service&rsquo;s unit files</li><li><code>systemctl list-dependencies something.service</code> - outputs a hierarchy of the service&rsquo;s dependencies (i.e. other services required by it)</li><li><code>systemctl show something.service</code> - outputs the properties associated with a service</li></ul><h2 id=unit-files>Unit files</h2><ul><li>unit files usually live in <code>/lib/systemd/system</code></li><li><code>.conf</code> files in <code>.d</code> directories like <code>/etc/systemd/system/something.service.d</code> containing &ldquo;snippets&rdquo; are merged on load with a unit definition to override or extend the unit definition with the &ldquo;snippet&rdquo;</li><li><code>.service</code> unit files in <code>/etc/systemd/system</code> completely override the unit definition usually found in <code>/lib/systemd/system</code></li><li><a href=https://www.digitalocean.com/community/tutorials/understanding-systemd-units-and-unit-files>Understanding systemd Units and Unit Files</a> offers a detailed overview of unit file &ldquo;anatomy&rdquo;</li></ul><p>A very basic example:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>[Unit]
</span></span><span style=display:flex><span>Description=something
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>[Service]
</span></span><span style=display:flex><span>ExecStart=/bin/bash -c &#34;something&#34;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>[Install]
</span></span><span style=display:flex><span>WantedBy=multi-user.target
</span></span></code></pre></div><h2 id=journalctl>journalctl</h2><p><code>journalctl</code> is the CLI tool for <code>journal</code>, which is responsible for collecting and managing <code>systemd</code> logs.</p><p>A few examples of working with <code>journalctl</code>:</p><ul><li><code>journalctl</code> - outputs the <code>systemd</code> logs</li><li><code>journalctl -u something -f</code> - outputs the logs for a service (Note that <code>journalctl</code> is a separate command and process for managing)</li><li><code>journalctl --since yesterday</code> or <code>journalctl --since 09:00 --until "1 hour ago"</code> can be used to filter logs to a specific window of time</li><li><code>journalctl -p err -b</code> - shows only log entries logged at the error level or above</li><li><code>journalctl -o json-pretty</code> - shows logs in formatted JSON (other output options exist, too)</li></ul></div><ul class=tags><li><a href=/tags/operations>operations</a></li><li><a href=/tags/linux>linux</a></li><li><a href=/tags/systemd>systemd</a></li></ul></article></div></main><footer><section><h1 id=about>Info</h1><div><h2>Mike Ball</h2><p>I live in Philadelphia and work as a multi-disciplinary software engineer & designer.</p><p>Over the years, I've developed front end web applications, built backend services, automated cloud infrastructure management, designed CI/CD pipelines for high scale distributed systems, and contributed to numerous open source software projects.</p><p>I've also worked in graphic and UX design. Buy prints of my illustrations at <a href=https://tiendah.bigcartel.com>Tiendah</a>.</div><div class=double><h2>Shop Tiendah</h2><ul class="gallery store-feed"></ul><h2>Instagram</h2><ul class="gallery ig-feed"></ul></div><div><h2>Etc.</h2><ul><li><a href=http://github.com/mdb>GitHub</a></li><li><a href=http://twitter.com/clapexcitement>Twitter</a></li><li><a href=https://instagram.com/clapclapexcitement>Instagram</a></li><li><a href=/index.xml>RSS Feed</a></li><li><a href=https://tiendah.bigcartel.com>Shop Tiendah</a></li></ul><h2>Contact</h2><p>Interested in working with me? <a href=mailto:mikedball@gmail.com>Get in touch</a>.</p></div></section></footer><script type=text/javascript src=/js/main.min.da52d8ec13bd557c9a5cee7d197a95ba9bbe47f8ba6e93b2a4ac2ca9ac18b707.js></script>
<script type=text/javascript>(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)})(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-54324621-1","auto"),ga("send","pageview")</script></body></html>