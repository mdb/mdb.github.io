<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>Deploying Wordpress to Pagodabox | Mike Ball</title><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=generator content="Hugo 0.101.0"><meta name=ROBOTS content="INDEX, FOLLOW"><link rel=stylesheet href=/main.min.03900073741bfad8af7335c0fa8fccfca2e69919dcec999961983091a2c75fb9.css></head><body class=blog-post><header><div class=mark><a href=/>Mike Ball</a></div><button>Toggle Navigation</button><div class=nav-wrap><nav class=primary><ul><li><a href=/blog>Blog</a></li><li><a href=#about>About</a></li></ul></nav><nav class=secondary><ul><li><a href=https://github.com/mdb>GitHub</a></li><li><a href=https://instagram.com/clapclapexcitement>Instagram</a></li></ul></nav><nav class=tertiary><ul><li><a href=https://tiendah.bigcartel.com>Shop</a></li><li><a href=#about>Contact</a></li></ul></nav></div></header><main role=main><div class=blog-post><aside class=divider><a href=/blog/>Blog</a></aside><time>March 24, 2012</time><article><header><h1>Deploying Wordpress to Pagodabox</h1></header><div><p>Services such as <a href=http://www.heroku.com/>Heroku</a> provide cloud deployment options for Rails, Sinatra, Django, and Node.js applications, but what about Wordpress? Pagodabox seems promising. Here&rsquo;s how to set up a Wordpress Pagodabox deployment workflow.</p><p>Note that these instructions are purposefully verbose in an effort to help those for whom such a workflow may be new and intimidating. Also note that these instructions assume you&rsquo;re using a Mac.</p><h2 id=set-up-a-local-instance-of-wordpress-using-mamp>Set up a local instance of Wordpress using MAMP</h2><p>There&rsquo;s probably a fun way to do this with <a href=http://www.vagrantup.com/>Vagrant</a>, but MAMP will serve our purposes here.</p><ol><li><p>Install <a href=http://www.mamp.info/%22>MAMP</a> if you haven&rsquo;t already done so. The free version is fine.</p></li><li><p>Run your MAMP Apache and MySQL servers by opening</p></li><li><p>Enter your MAMP <code>htdocs</code> directory:</p></li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cd /Applications/MAMP/htdocs
</span></span></code></pre></div><ol start=4><li>Download Wordpress:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>wget http://wordpress.org/latest.tar.gz
</span></span></code></pre></div><ol start=5><li>Unzip Wordpress:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>tar -xzvf latest.tar.gz
</span></span></code></pre></div><ol start=6><li>Change the name of the resulting <code>wordpress</code> directory to something more descriptive:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mv wordpress your_site
</span></span></code></pre></div><ol start=7><li>Enter the MySQL command line client:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>/Applications/MAMP/Library/bin/mysql -u root -p
</span></span></code></pre></div><ol start=8><li>Create a MySQL database for <code>your_site</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>CREATE DATABASE your_database_name;
</span></span></code></pre></div><ol start=9><li><p>Exit the MySQL command line client with <code>Ctrl + C</code></p></li><li><p>Create a <code>wp-config.php</code> file:</p></li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cp your_site/wp-config-sample.php your_site/wp-config.php
</span></span></code></pre></div><ol start=11><li>Add your local database credentials to your newly created <code>wp-config.php</code> file:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#a6e22e>define</span>(<span style=color:#e6db74>&#39;DB_NAME&#39;</span>, <span style=color:#e6db74>&#39;your_database_name&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>define</span>(<span style=color:#e6db74>&#39;DB_USER&#39;</span>, <span style=color:#e6db74>&#39;root&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>define</span>(<span style=color:#e6db74>&#39;DB_PASSWORD&#39;</span>, <span style=color:#e6db74>&#39;root&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>define</span>(<span style=color:#e6db74>&#39;DB_HOST&#39;</span>, <span style=color:#e6db74>&#39;localhost&#39;</span>);
</span></span></code></pre></div><ol start=12><li>Run the Wordpress installation script by visiting <code>http://localhost:8888/your_site/wp-admin/install.php</code> in your web browser.</li></ol><h2 id=set-up-your-wordpress-app-as-a-git-repository>Set up your Wordpress app as a Git repository</h2><p>Note that these instructions assume you have Git installed.</p><ol><li>Make your Wordpress app a Git repository:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cd your_site
</span></span><span style=display:flex><span>git init
</span></span></code></pre></div><ol start=2><li>Add all of <code>your_site</code>&rsquo;s files to your repository:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>git add .
</span></span></code></pre></div><p>3.Commit your code:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>git commit -m <span style=color:#e6db74>&#34;First commit.&#34;</span>
</span></span></code></pre></div><h2 id=set-up-your-wordpress-app-for-pagodabox-deployment>Set up your Wordpress app for Pagodabox deployment</h2><p>4.Create a Boxfile. This is the Pagodabox config file:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>touch Boxfile
</span></span></code></pre></div><p>Add the following to your Boxfile to set up a basic Wordpress configuration:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>web1: <span style=color:#75715e>#component type &amp; number</span>
</span></span><span style=display:flex><span>name: wp <span style=color:#75715e>#component settings</span>
</span></span><span style=display:flex><span>shared_writable_dirs:
</span></span><span style=display:flex><span>  - wp-content/uploads
</span></span></code></pre></div><ol start=5><li>Save and commit your Boxfile.</li></ol><h2 id=set-up-your-pagodabox-account>Set up your Pagodabox account</h2><p>Follow the instructions provided by <a href=https://dashboard.pagodabox.com/account/register>Pagodabox</a>. In short, you&rsquo;ll create an account, create an app for <code>your_site</code>, generate an SSH key if you don&rsquo;t already have one, and provide Pagodabox your SSH key.</p><h2 id=deploy-your-wordpress-app-to-pagodabox>Deploy your Wordpress app to Pagodabox</h2><ol><li>Declare a <code>pagodabox</code> remote repository:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>git remote add pagoda git@git.pagodabox.com:your_site.git
</span></span></code></pre></div><ol start=2><li>Push your code to Pagodabox:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>git push pagodabox master
</span></span></code></pre></div><p>At this point, you can vew your site at <code>http://your_site.pagodabox.com</code>, although you should see an &ldquo;Error Connecting to Database&rdquo; message in your browser. This is because <code>your_site</code> isn&rsquo;t yet wired up to a Pagodabox MySQL database.</p><h2 id=set-up-a-pagodabox-mysql-database>Set up a Pagodabox MySQL database</h2><ol><li>Log into Pagodabox, visit the dashboard for your Wordpress app, and click &ldquo;Add Database.&rdquo;</li><li>Click &ldquo;Environment vars&rdquo; and add a <code>PLATFORM = PAGODABOX</code> variable.</li><li>Because Pagodabox automatically houses your database credentials in environment variables, you can now connect your Wordpress app to your local database while working locally and to your Pagodabox database when it&rsquo;s deployed to Pagodabox. To connect to different databases based on environment, open your <code>wp-config.php</code> file and replace your local database credentials with the following:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>isset</span>($_SERVER[<span style=color:#e6db74>&#39;PLATFORM&#39;</span>]) <span style=color:#f92672>&amp;&amp;</span> $_SERVER[<span style=color:#e6db74>&#39;PLATFORM&#39;</span>] <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;PAGODABOX&#39;</span>) {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>define</span>(<span style=color:#e6db74>&#39;DB_NAME&#39;</span>, $_SERVER[<span style=color:#e6db74>&#39;DB1_NAME&#39;</span>]);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>define</span>(<span style=color:#e6db74>&#39;DB_USER&#39;</span>, $_SERVER[<span style=color:#e6db74>&#39;DB1_USER&#39;</span>]);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>define</span>(<span style=color:#e6db74>&#39;DB_PASSWORD&#39;</span>, $_SERVER[<span style=color:#e6db74>&#39;DB1_PASS&#39;</span>]);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>define</span> (<span style=color:#e6db74>&#39;DB_HOST&#39;</span>, $_SERVER[<span style=color:#e6db74>&#39;DB1_HOST&#39;</span>] <span style=color:#f92672>.</span> <span style=color:#e6db74>&#39;:&#39;</span> <span style=color:#f92672>.</span> $_SERVER[<span style=color:#e6db74>&#39;DB1_PORT&#39;</span>]);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>define</span>(<span style=color:#e6db74>&#39;DB_NAME&#39;</span>, <span style=color:#e6db74>&#39;your_database_name&#39;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>define</span>(<span style=color:#e6db74>&#39;DB_USER&#39;</span>, <span style=color:#e6db74>&#39;root&#39;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>define</span>(<span style=color:#e6db74>&#39;DB_PASSWORD&#39;</span>, <span style=color:#e6db74>&#39;root&#39;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>define</span>(<span style=color:#e6db74>&#39;DB_HOST&#39;</span>, <span style=color:#e6db74>&#39;localhost&#39;</span>);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=4><li>Commit your code and push your Wordpress app to Pagodabox:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>git add wp-config.php
</span></span><span style=display:flex><span>git commit -m <span style=color:#e6db74>&#34;Wordpress now detects environment and connects to the appropriate database accordingly.&#34;</span>
</span></span><span style=display:flex><span>git push pagodabox master
</span></span></code></pre></div><ol start=5><li>Run the Wordpress installation script on Pagodabox by visiting <code>http://your_site.pagodabox.com/wp-admin/install.php</code>.</li></ol></div><ul class=tags><li><a href=/tags/wordpress>wordpress</a></li><li><a href=/tags/cloud>cloud</a></li><li><a href=/tags/pagodabox>pagodabox</a></li></ul></article></div></main><footer><section><h1 id=about>Info</h1><div><h2>Mike Ball</h2><p>I live in Philadelphia and work as a multi-disciplinary software engineer & designer.</p><p>Over the years, I've developed front end UIs, server backends, automated cloud infrastructure provisioning, built continuous deployment pipelines for highly available applications, and contributed to numerous open source software projects.</p><p>I've also worked in graphic and UX design. Buy prints of my illustrations at <a href=https://tiendah.bigcartel.com>Tiendah</a>.</div><div class=double><h2>Shop Tiendah</h2><ul class="gallery store-feed"></ul><h2>Instagram</h2><ul class="gallery ig-feed"></ul></div><div><h2>Etc.</h2><ul><li><a href=http://github.com/mdb>GitHub</a></li><li><a href=http://twitter.com/clapexcitement>Twitter</a></li><li><a href=https://instagram.com/clapclapexcitement>Instagram</a></li><li><a href=/index.xml>RSS Feed</a></li><li><a href=https://tiendah.bigcartel.com>Shop Tiendah</a></li></ul><h2>Contact</h2><p>Interested in working with me? <a href=mailto:mikedball@gmail.com>Get in touch</a>.</p></div></section></footer><script type=text/javascript src=/js/main.min.da52d8ec13bd557c9a5cee7d197a95ba9bbe47f8ba6e93b2a4ac2ca9ac18b707.js></script>
<script type=text/javascript>(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)})(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-54324621-1","auto"),ga("send","pageview")</script></body></html>